
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta property="og:title" content="高見龍" />
<meta property="og:author" content="高見龍" />
<meta property="og:site_name" content="高見龍" />
<meta property="og:locale" content="en_US" />
<meta property="fb:app_id" content="212934732101925" />

<meta property="og:image" content="" />
<meta property="og:description" content="" />
<meta property="og:url" content="http://blog.eddie.com.tw" />
<meta property="og:type" content="blog" />


  <title>高見龍</title>
  <meta name="author" content="高見龍">

  
  <meta name="description" content="Oops! 發現最後一篇blog竟然已經是去年的事了!! 是時間過太快還是我太懶了? 最近因為幾個案子在趕著要上線，不久前的OSDC.tw沒辦法全程參加，只好挑自已喜歡的Session參加(ericsk的GAEO比我想像中的還好用)。 以前某個我不喜歡的老闆曾跟我說過， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.eddie.com.tw/page/32/">
  <link href="/images/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  <link href="http://feeds.feedburner.com/aquarianboy" rel="alternate" title="高見龍" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-337088-13']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">高見龍</a></h1>
  
    <h2>iOS app/Ruby/Rails Developer, 喜愛非主流的新玩具 :)</h2>
  
</hgroup>

  </header>
  <div id="banner_img"></div>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/aquarianboy" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.eddie.com.tw" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/presentations">Presentations</a></li>
  <li><a href="/slides">Slides</a></li>
  <li><a href="/screencasts">Screencasts & Videos</a></li>
  <li><a href="/about-eddie">About Me</a></li>
</ul>
</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/05/06/speak-on-the-stage/">上台講話</a></h1>
      
        <fb:like href="http://blog.eddie.com.tw/2009/05/06/speak-on-the-stage/" layout="button_count" show_faces="false" action="like" colorscheme="light"></fb:like>
      
    

    
      <p class="meta">
        




  
<time datetime="2009-05-06T14:45:00+08:00" pubdate>May 6<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Oops! 發現最後一篇blog竟然已經是去年的事了!! 是時間過太快還是我太懶了?</p>

<p>最近因為幾個案子在趕著要上線，不久前的<a href="http://osdc.tw/">OSDC.tw</a>沒辦法全程參加，只好挑自已喜歡的Session參加(<a href="http://blog.ericsk.org/">ericsk</a>的<a href="http://code.google.com/p/google-app-engine-oil/">GAEO</a>比我想像中的還好用)。</p>

<p>以前某個我不喜歡的老闆曾跟我說過，做presentation就像表演一樣。</p>

<p>近來我自告奮勇的找了一些對flash有興趣的朋友們每週來聚會，每次約2小時，我教大家怎麼來學 <a href="http://en.wikipedia.org/wiki/ActionScript">ActionScript3.0</a>，沒另外收費(只需各自分擔場地費，我還太嫩，還不到那種敢收學費的等級)。</p>

<p>常聽到「這個東西我懂，我只是不會講而已」，但我一直相信，真的懂的人一定是講得出來的；不會講不代表真的不會，只是還沒能完全透徹，某個環節沒學好，講不出來。</p>

<p>在台上講話實在是件不容易的事，一來得先克服緊張感，二來得讓自已的腦袋保持清醒。</p>

<p>當然我也沒這麼佛心，開這樣的課當然是有目的：</p>

<ol>
<li>透過在台上講課，讓自已對AS3更熟悉。</li>
<li>訓練自已講話的技巧，練習怎麼掌握台下的反應(可能講太快或一下子講太難)。</li>
<li>透過每週準備課程，讓自已不會跟AS3離太遠。</li>
</ol>


<p>越是複雜的技術，要做這種大眾化的教學困難度也越高，像是知名的flash totur <a href="http://theflashblog.com/">Lee Brimelow</a> 用影音的方式來教學，清楚又易懂。</p>

<p>最近在路邊牆上貼的一段話：「有困難是能力不夠，有麻煩是方法不對」。看來，這條路還相當漫長  :)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/12/23/doctrine-the-php-orm-framework/">Doctrine, the PHP ORM Framework</a></h1>
      
        <fb:like href="http://blog.eddie.com.tw/2008/12/23/doctrine-the-php-orm-framework/" layout="button_count" show_faces="false" action="like" colorscheme="light"></fb:like>
      
    

    
      <p class="meta">
        




  
<time datetime="2008-12-23T14:14:00+08:00" pubdate>Dec 23<span>rd</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/2008/doctrine-logo.png" alt="image" /></p>

<p><a href="http://www.doctrine-project.org/">Doctrine</a>是一個在PHP上的資料庫ORM(Object Relational Mapper)，最近手邊的幾個小案子透過Doctrine來實作。ORM的確是讓開發者少寫不少的SQL查詢，但相對的效能一定是比簡單的SQL要來得 差，我想魚跟熊掌要兼得並不容易，便利跟效能之間總有個天平讓開發者來自已調整，所以ORM好不好用就見人見志囉。</p>

<h2>一、前置作業：</h2>

<h3>1. 系統需求</h3>

<p>依官網上面提到的，Doctrine需要PHP 5.2.3以上的版本，除此之外就不用再另外安裝其它的套件或函式庫即可運作，不過如果要使用PDO(<a href="http://tw2.php.net/manual/en/intro.pdo.php">PHP Data Object</a>)的話，則可能會需要另外安裝PDO驅動程式。</p>

<h3>2. 檢查PDO驅動程式</h3>

<p>如果你要用PDO的話，想要知道你的主機上是不是有安裝你所需要的PDO驅動程式，只要一行簡單的PHP程式放到主機上執行：</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span> <span class="nb">phpinfo</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>


<p>如果你有看到一段PDO的資訊，那差不多應該就是有安裝了，再確認一下是不是有你要的版本，以及是否啟用即可。</p>

<h2>二、取得原始檔</h2>

<p>有幾種取得Doctrine的方法：</p>

<ul>
<li>SVN(Subversion)</li>
<li>Pear</li>
<li>Zip-package</li>
</ul>


<p>如果你熟悉SVN的操作的話，這應該是最簡單使用的了。如果你只是想試玩一下Doctrine的功能的話，你可以下載官網上打包好的<a href="http://www.doctrine-project.org/download/1_0_5/sandbox/1/format/tgz">Sandbox套件</a>來玩。我個人比較喜歡官方打包好的壓縮檔 :)</p>

<h3>什麼是Sandbox套件?</h3>

<p>Doctrine網站的<a href="http://www.doctrine-project.org/download">下載區</a>有貼心的打包了免設定的方便套件，直接下載、解壓縮後，就可以拿來試玩了。這裡面包括了一些範例schema檔案以及可以匯入的資料檔，讓你可以很快的就可以開始體驗Doctrine的優點。</p>

<h2>三、開始第一個專案</h2>

<p>在Doctrine裡，Doctrine_Record是最基本的元件。資料庫裡的每個資料表都會有一個對應的Doctrine_Record類別。這個類別是以<a href="http://en.wikipedia.org/wiki/Active_record_pattern">Active Record</a>這個設計模式實作的，所以在其它語言像是在ROR(Ruby on Rails)上才看得到方便功能，在Doctrine裡也可以使用到了，即使是複雜的資料庫操作，透過這個類別也可以簡單的完成。</p>

<p>在使用Doctrine_Record來建立資料表時，如果沒有特別指定Primary Key的話，Doctrine會自動幫你加一個叫做<code>id</code>的主索引欄位(自動編號)。接下來你需要做的事情，就是建立一個繼承自 Doctrine_Record類別的子類別，然後透過<code>setTableDefinition()</code>以及<code>hasColumn()</code>就可以來建立你的資料表。</p>

<p>為了單純一些，我們這裡只先用一個表格做範例(多個表格之間的關聯性操作，例如一對一、一對多、多對多等關係，再另外開幾篇再寫)。假設我們現在要建立一個 叫做<code>member</code>的會員資料表，這個資料表裡會有id、username、password以及建立日期這幾個欄位，我們可以這樣做：</p>

<p>檔案：models/Member.php</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>     <span class="k">class</span> <span class="nc">Member</span> <span class="k">extends</span> <span class="nx">Doctrine_Record</span>
</span><span class='line'>     <span class="p">{</span>
</span><span class='line'>         <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
</span><span class='line'>         <span class="p">{</span>
</span><span class='line'>             <span class="c1">// 預設將會使用跟&quot;user&quot;做為資料表的名稱(同名)</span>
</span><span class='line'>             <span class="c1">// 並且會自動加一個欄位id的主索引鍵</span>
</span><span class='line'>             <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
</span><span class='line'>             <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
</span><span class='line'>         <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>         <span class="k">public</span> <span class="k">function</span> <span class="nf">setUp</span><span class="p">()</span>
</span><span class='line'>         <span class="p">{</span>
</span><span class='line'>             <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">actAs</span><span class="p">(</span><span class="s1">&#39;Timestampable&#39;</span><span class="p">);</span>
</span><span class='line'>         <span class="p">}</span>
</span><span class='line'>     <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>除了手工打造模型類別外，你也可以使用YAML格式的檔案來建立資料表的schema檔案，底下這個範例的設定跟上面這個類別是一樣的意思，而且也可以透過Doctrine的一些指令來互相轉換。</p>

<p>檔案：schemas/schema.yml</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">Member</span><span class="p-Indicator">:</span>
</span><span class='line'>  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
</span><span class='line'>    <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string(30)</span>
</span><span class='line'>    <span class="l-Scalar-Plain">password</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string(30)</span>
</span><span class='line'>  <span class="l-Scalar-Plain">actAs</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">Timestampable</span><span class="p-Indicator">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>這裡要注意的是，<strong>YAML的縮排是有意義的</strong>，所以要特別注意縮排的層級。你可以用一行簡單的語法就可以把YAML檔案(.yml)轉換成模型類別(.php)：</p>

<p>檔案：createMode.php</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>     <span class="k">require_once</span> <span class="s1">&#39;config/doctrine_config.php&#39;</span><span class="p">;</span>
</span><span class='line'>     <span class="nx">Doctrine</span><span class="o">::</span><span class="na">generateModelsFromYaml</span><span class="p">(</span><span class="s1">&#39;schemas/schema.yml&#39;</span><span class="p">,</span> <span class="s1">&#39;models&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>執行之後看一下models資料夾有一個自動產生的generated資料夾(如下圖)，你會看到有一個<code>Member.php</code>以 及<code>BaseMember.php</code>。其中，<code>Member.php</code>是可以讓你自己定義一些功能用的，而<code>BaseMember.php</code>裡的內容則是 依據YAML的內容幫你寫好的。(要特別注意BaseMember類別會在每次執行轉換的時候重新產生一次，而Member類別只會產生一次)。</p>

<p><img src="/images/2008/doctrine-5.png" alt="image" /></p>

<p>我們現在有一個透過YAML建立的Doctrine_Record類別，接下來就可以把它匯入資料庫來建立資料表了。</p>

<p>檔案：modelToDatabase.php</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>     <span class="k">require_once</span> <span class="s1">&#39;config/doctrine_config.php&#39;</span><span class="p">;</span>
</span><span class='line'>     <span class="c1">// 建立資料表</span>
</span><span class='line'>     <span class="nx">Doctrine</span><span class="o">::</span><span class="na">createTablesFromArray</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;Member&#39;</span><span class="p">));</span>
</span></code></pre></td></tr></table></div></figure>


<p>這樣就搞定了!看一下資料表的樣子：</p>

<p><img src="/images/2008/doctrine-1.png" alt="image" /></p>

<p>如前面說的，它會自動加上<code>id</code>這個欄位，而<code>Timestampable</code>則會自動幫忙加上<code>created_at</code>及<code>updated_at</code>這兩個欄位。</p>

<p>現在我們有一個資料表以及一個對應的模型類別可以讓我們來練習資料的基本操作了(新增、修改、刪除及查詢)。</p>

<h3>新增：</h3>

<p>檔案：testInsert.php</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>    <span class="k">require_once</span> <span class="s1">&#39;config/doctrine_config.php&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$myTable</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Member</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$myTable</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="s1">&#39;eddie&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$myTable</span><span class="o">-&gt;</span><span class="na">password</span> <span class="o">=</span> <span class="s1">&#39;mypassword&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$myTable</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>資料表欄位的指定，除了上面這種物件式的存取方式外，也可以使用陣列的方式：</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>  <span class="nv">$myTable</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Member</span><span class="p">;</span>
</span><span class='line'>  <span class="nv">$myTable</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;eddie&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="nv">$myTable</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mypassword&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="nv">$myTable</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>不用寫什麼insert..into..，只要一個<code>save()</code>就完成了! 回頭看一下資料表就會發現，有一些神奇的事情它幫忙做了。上面這段程式碼執行後，member資料表會長得像這樣：</p>

<p><img src="/images/2008/doctrine-2.png" alt="image" /></p>

<h3>修改：</h3>

<p>假設剛剛寫入的那筆資料的id編號是1號，更新方法是先找到它，然後一樣用<code>save()</code>來更新：</p>

<p>檔案：testUpdate.php</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>    <span class="k">require_once</span> <span class="s1">&#39;config/doctrine_config.php&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$myTable</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Member</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$record</span> <span class="o">=</span> <span class="nv">$myTable</span><span class="o">-&gt;</span><span class="na">getTable</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>    <span class="nv">$record</span><span class="o">-&gt;</span><span class="na">password</span> <span class="o">=</span> <span class="s1">&#39;mynewpassword&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$record</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>結果如下：</p>

<p><img src="/images/2008/doctrine-3.png" alt="image" /></p>

<p>你會發現，password欄位變成”mynewpassword”之外，它的更新時間(updated_at)也跟著更新了。</p>

<h3>刪除：</h3>

<p>跟更新差不多，也是先找到那筆資料後，再給它一個<code>delete()</code>：</p>

<p>檔案：testDelete.php</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>    <span class="k">require_once</span> <span class="s1">&#39;config/doctrine_config.php&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$myTable</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Member</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$myTable</span><span class="o">-&gt;</span><span class="na">getTable</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<h3>查詢：</h3>

<p>假設我要找出id編號是1號的資料，可以這樣做：</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>  <span class="nv">$myTable</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Member</span><span class="p">;</span>
</span><span class='line'>  <span class="nv">$result</span> <span class="o">=</span><span class="nv">$myTable</span><span class="o">-&gt;</span><span class="na">getTable</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>除了透過<code>find</code>方法外，Doctrine還有它自已一套叫做<code>DQL</code>的語法，使用方法大致如下：</p>

<p>檔案：testDQL.php</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>    <span class="k">require_once</span> <span class="s1">&#39;config/doctrine_config.php&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$myTable</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Member</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$record</span> <span class="o">=</span> <span class="nv">$myTable</span><span class="o">-&gt;</span><span class="na">getTable</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>    <span class="nv">$record</span><span class="o">-&gt;</span><span class="na">password</span> <span class="o">=</span> <span class="s1">&#39;mynewpassword&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$record</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
</span><span class='line'>    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">Doctrine_Query</span><span class="o">::</span><span class="na">CREATE</span><span class="p">()</span>
</span><span class='line'>                <span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
</span><span class='line'>                <span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span><span class="s1">&#39;Member&#39;</span><span class="p">)</span>
</span><span class='line'>                <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;id = ?&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>                <span class="o">-&gt;</span><span class="na">fetchArray</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">print_r</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>印出來的結果如下：</p>

<p><img src="/images/2008/doctrine-4.png" alt="image" /></p>

<p>上面的DQL相當於底下的SQL：</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">member</span> <span class="k">where</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>其實DQL的細節也可以另外來寫一篇 :)</p>

<h2>結論</h2>

<p>老實說，如果只是簡單的查詢，Doctrine寫起來不見得比原本的SQL快，而且效能又比較差一些，但如果是比較複雜的查詢，透過Doctrine包裝好 的一些方法，可以不用去想那些單引號、雙引號的問題外，也可以安全的避開可能的危機(例如SQL Injection) ，就如同最前面說的，便利跟效能，我會比較偏向便利的這一方。</p>

<p>更多的細節，可參考<a href="http://www.doctrine-project.org/documentation">Doctrine官網手冊</a>，寫得滿詳細的。</p>

<p>上面的程式碼我也有打包了一份供大家參考囉 :)</p>

<p><a href="http://blog.eddie.com.tw/gallery/1/doctrine-lession1.rar">檔案下載</a></p>

<p>使用前請先看一下config/doctrine_config.php裡面的資料庫相關設定。</p>

<h2>相關連結</h2>

<ul>
<li><a href="http://www.doctrine-project.org/">Doctrine官方網站</a></li>
<li><a href="http://groups.google.com/group/doctrine-user">Doctrine User Group</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/10/12/amfphp-tutorial/">AMFPHP - 搭起 Flash 與 PHP 的美麗橋樑</a></h1>
      
        <fb:like href="http://blog.eddie.com.tw/2008/10/12/amfphp-tutorial/" layout="button_count" show_faces="false" action="like" colorscheme="light"></fb:like>
      
    

    
      <p class="meta">
        




  
<time datetime="2008-10-12T11:24:00+08:00" pubdate>Oct 12<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/2008/amfphp_logo.gif" alt="image" /></p>

<p>Flash在跟Server在交換資料，比較常見的是一般的文字訊息或是XML，我自己在趕時間的時候，會偷懶的隨便echo一個字出來知會Flash說server程式已經做完了或是程式執行之後的結果，不趕時間且資料量較多的時候，則會乖乖的用XML。不過，最近開始我比較常用的是AMF跟<a href="http://www.json.org/">JSON</a>這兩個方法，其實都還滿方便的，各有其優缺點。</p>

<p>AMF(Action Message Format)，由<a href="http://www.adobe.com/">Adobe</a>公司推出的規格，主要是用來給flash以RPC的方式來交換資料用的，在flash player 6的版本就已經開始支援(AMF0)，直到flash player 9才又推出新規格(AMF3)。其它細節可參考：<a href="http://en.wikipedia.org/wiki/Action_Message_Format">http://en.wikipedia.org/wiki/Action_Message_Format</a></p>

<p>接下來就來個簡單的實作吧 :)</p>

<h4>1. 下載AMF gateway</h4>

<p>找個自己順手的語言</p>

<ul>
<li><a href="http://www.amfphp.org/">AMFPHP</a>：這是PHP的</li>
<li><a href="http://pyamf.org/">PyAMF</a>：這是Python的(還不熟，努力學習中)</li>
<li><a href="http://amfnet.openmymind.net/">AMF.NET</a>：這是.NET的</li>
</ul>


<p>光看名字大概就能猜到它的後端是用什麼做的。其它還有for Java或其它的，有興趣的可以繼續google翻翻看。</p>

<h4>2. 安裝AMF gateway(以AMFPHP為例)</h4>

<p>安裝方法很容易的，只要把下載下來的壓縮檔解開，放在Web server底下一個自己找得到的路徑就行了。我是放在<code>http://127.0.0.1/test/amfphp/</code>底下。</p>

<p>AMFPHP有提供一個很棒的Service Browser，網址是<code>http://127.0.0.1/test/amfphp/browser</code>，這是個用Flex做的介面，可以清楚列出目前在AMF gateway上的服務。</p>

<h4>3. 在AMF gateway上新增一個服務</h4>

<p>我做了一個簡單的php類別檔，存檔為<code>callme.php</code>，並放在AMF gateway的<code>services</code>資料夾裡面(文末有原始檔連結)。PHP不像Java或AS3一樣硬性規定類別名稱一定要跟檔名一樣..至少php5還沒有，但建立這習慣也不錯。</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'>  <span class="k">class</span> <span class="nc">callme</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">function</span> <span class="nf">callmeplease</span><span class="p">(</span><span class="nv">$text</span><span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="nv">$text</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>上面，我做了一個<code>callme</code>的類別，然後裡面放了一個<code>callmeplease</code>的方法，這個方法會接收一個參數，執行完成之後，會把傳入的參數return回來。這裡只是簡單直接return而已，更複雜的資料庫存取程式也可以寫在這裡&#8230;</p>

<p>接下來看一下Service Browser，會發現寫寫的那個新的服務在的左手邊的列表裡：</p>

<p><img src="/images/2008/amfphp.gif" alt="image" /></p>

<p>在右邊的Text輸入文字，按一下右邊的「Call」，應該就可以直接看到結果。(中文支持問題請見文末補充)</p>

<h4>4. 新增一個Fla(這裡以AS3.0為例)</h4>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='actionscript'><span class='line'><span class="kd">import</span> <span class="nx">flash</span><span class="p">.</span><span class="nx">net</span><span class="p">.</span><span class="o">*;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 新增一個NetConnection物件</span>
</span><span class='line'><span class="k">var</span> <span class="nx">test</span><span class="o">:</span><span class="nb">NetConnection</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">NetConnection</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 連上AMF gateway</span>
</span><span class='line'><span class="c1">// 這裡每家AMF gateway的實作方法應該都有差別，細節請記得看該實作說明</span>
</span><span class='line'><span class="nx">test</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="s1">&#39;http://127.0.0.1/test/amfphp/gateway.php&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 準備一個Responder物件來接收事件，用法及參數請參考F1說明</span>
</span><span class='line'><span class="k">var</span> <span class="nx">returnResult</span><span class="o">:</span><span class="nb">Responder</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Responder</span><span class="p">(</span><span class="nx">ok</span><span class="o">,</span> <span class="nx">ng</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">ok</span><span class="p">(</span><span class="nx">res</span><span class="o">:</span><span class="nb">Object</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span> <span class="p">{</span>
</span><span class='line'>  <span class="nf">trace</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">ng</span><span class="p">(</span><span class="nx">res</span><span class="o">:</span><span class="nb">Object</span><span class="p">)</span><span class="o">:</span><span class="nx">void</span> <span class="p">{</span>
</span><span class='line'>  <span class="nf">trace</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//以上，我做了ok跟ng兩個簡單小function，分別是trace出它們接收到的物件</span>
</span><span class='line'>
</span><span class='line'><span class="nx">test</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">&#39;callme.callmeplease&#39;</span><span class="o">,</span> <span class="nx">returnResult</span><span class="o">,</span> <span class="s1">&#39;hi, flash&#39;</span><span class="p">);</span>
</span><span class='line'><span class="c1">// 這裡是最重要的動作，就是直接用call這個方法</span>
</span><span class='line'><span class="c1">// &quot;呼叫&quot;在gateway上面的callme這個服務裡的callmeplease這個方法</span>
</span><span class='line'><span class="c1">// 第二個參數是接收反應的responder，第三個參數是給callmeplease的參數</span>
</span></code></pre></td></tr></table></div></figure>


<p>以上，<code>callme.callmeplease</code>會把”hi, flash”傳給AMF gateway，然後gateway回傳”hi, flash”回來給flash。順利的話，Ctrl + Enter執行，就會在output視窗看到輸出的東西了。</p>

<p>就這樣，你的Flash已經可以跟各家有支援AMF的gateway”對談”了。</p>

<p>上面提到的原始檔在<a href="http://code.eddie.com.tw/downloads/flash/AMF.rar">這裡</a>可以拿得到(其實沒幾行字，就一個.php跟.fla)</p>

<p>還是看不懂嗎? 沒關係，這裡有個很棒的影音教學，看完跟著作一遍就知道大概是怎麼運作的了
<a href="http://www.gotoandlearn.com/player.php?id=78">http://www.gotoandlearn.com/player.php?id=78</a></p>

<p>希望對大家有幫助 :)</p>

<h5>補充1：</h5>

<p>AMF不久之後已經可以在Zend Framework裡找到native module了，ZF真的是包山包海了 :) ((而且ZF-AMF就是由AMFPHP裡的主導人Wade Arnold來親自操刀)。</p>

<h5>補充2：</h5>

<p>AMFPHP預設的編碼是不支援中文的(會出現亂碼)，不過只要修改一下gateway的程式碼即可。</p>

<p>使用文字編輯器，開啟AMFPHP資料夾的gateway.php，應該可以找到一段跟字碼有關的：</p>

<pre><code>$gateway-&gt;setCharsetHandler("utf8_decode", "ISO-8859-1", "ISO-8859-1");
</code></pre>

<p>把它修改成：</p>

<pre><code>$gateway-&gt;setCharsetHandler("utf8_decode", "UTF-8", "UTF-8");
</code></pre>

<p>或是如果你的PHP模組裡有iconv的話也可以這樣改：</p>

<pre><code>$gateway-&gt;setCharsetHandler("iconv","UTF-8","UTF-8");
</code></pre>

<p>記得，不要改flash裡的<code>useCodePage = true</code>，雖然可能也ok，但這是走回頭路&#8230;能使用Unicode就盡量使用它吧 :)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/09/16/dojo-toolkit-tutorial-part-1/">dojo toolkit入門(一)</a></h1>
      
        <fb:like href="http://blog.eddie.com.tw/2008/09/16/dojo-toolkit-tutorial-part-1/" layout="button_count" show_faces="false" action="like" colorscheme="light"></fb:like>
      
    

    
      <p class="meta">
        




  
<time datetime="2008-09-16T10:58:00+08:00" pubdate>Sep 16<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/images/2008/dojo_logo.jpg" alt="image" /></p>

<p>雖然我個人還是比較喜歡<a href="http://jquery.com/">jQuery</a>的簡潔方便，而且一些常用的function也都jQuery化了，不過畢竟<a href="http://dojotoolkit.org/">Dojo</a>從<a href="http://framework.zend.com/">Zend Framework</a> 1.6版後就被officially的收進去了，為了ZF寫起來的完整性，還是花點時間來研究一下。</p>

<p>廢話不多說，先來試玩一下!</p>

<h3>步驟一：下載它</h3>

<p>到<a href="http://dojotoolkit.org/">dojo toolkit</a>的網站即可下載(不過其實也可以不用下載..請見步驟二)</p>

<h3>步驟二：安裝它</h3>

<p>基本上，下載壓縮檔回來後，解壓縮後放在你的網頁的目錄(放哪裡都可，只要你能找得到就好)。假設我放在js/dojo底下，接下來只要一行：</p>

<pre><code>&lt;script type="text/javascript" src="js/dojo/dojo/dojo.js"&gt;&lt;/script&gt;
</code></pre>

<p>這樣就算完成安裝了..</p>

<p>除了這種方式外，也有不用下載整包回來的方法，就是使用別人家(CDN or Google)準備好的服務：</p>

<h4>1. AOL的CDN(Content Delivery Network)</h4>

<pre><code>&lt;script type="text/javascript" src="http://o.aolcdn.com/dojo/1.1.1/dojo/dojo.xd.js"&gt;&lt;/script&gt;
</code></pre>

<h4>2. Google Ajax Libraries API：</h4>

<pre><code>&lt;script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/dojo/1.1.1/dojo/dojo.xd.js"&gt;&lt;/script&gt;
</code></pre>

<p>註：Google上還有host別的Ajax library(如jQuery、MooTools..等)，詳情請洽<a href="http://code.google.com/apis/ajaxlibs">Google Ajax Libraries API</a>。</p>

<p>使用線上版跟本機版各有優缺點，線上版的好處就是省頻寬，畢竟dojo整包檔案解開壓縮也不小，有十幾MB，若能使用像Google這種又快又穩定的主機頻 寬來host，多少也是可以省一些的；當然缺點就是畢竟是別人家免費提供的服務，萬一有什麼”萬一”的話，可能會導致全站的功能都出問題。而本機版的優缺 點就剛好跟線上版的相反(個人比較偏好本機版安裝法)。</p>

<h3>步驟三：使用它</h3>

<p>在步驟二的地方，當你指定<code>&lt;script&gt;</code>的<code>src</code>的時候，其實就已經使用了。先來試一下DOM selector跟onLoad事件：</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="cp">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
</span><span class='line'><span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'><span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">&quot;Content-Type&quot;</span> <span class="na">content=</span><span class="s">&quot;text/html; charset=utf-8&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;title&gt;</span>Dojo Test<span class="nt">&lt;/title&gt;</span>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;http://o.aolcdn.com/dojo/1.1.1/dojo/dojo.xd.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nx">dojo</span><span class="p">.</span><span class="nx">addOnLoad</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>    <span class="nx">dojo</span><span class="p">.</span><span class="nx">byId</span><span class="p">(</span><span class="s2">&quot;test1&quot;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s2">&quot;Hello, Dojo&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">dojo</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">dojo</span><span class="p">.</span><span class="nx">byId</span><span class="p">(</span><span class="s2">&quot;btn1&quot;</span><span class="p">),</span> <span class="s2">&quot;onclick&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">){</span>
</span><span class='line'>      <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Hello again, Dojo!&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">})</span>
</span><span class='line'> <span class="p">});</span>
</span><span class='line'><span class="nt">&lt;/script&gt;</span>
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;test1&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class='line'><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">value=</span><span class="s">&quot;clickme!&quot;</span> <span class="na">id=</span><span class="s">&quot;btn1&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://labs.eddie.com.tw/dojo/hello.htm">線上測試</a></p>

<p>簡單的說明上面用到的幾個功能：</p>

<h4>1. dojo.addOnLoad</h4>

<p>就是在頁面讀取完成之後會做的事，有點像一般的<code>onLoad</code>功能，不過<strong>順序在它之後</strong>。</p>

<h4>2. dojo.byId(“test1″)</h4>

<p>這將會回傳在頁面裡面叫id叫做<code>test1</code>的元素(在上面這裡是一個div)，功能有點像原來的<code>document.getElementById()</code>。再透過設定這個回傳回來的物件的<code>innerHTML</code>的值，就可以直接讓這個Div區塊裡面的值有變化。</p>

<h4>3. dojo.connect()</h4>

<p>這個比較有趣，這個function可以傳入四個參數。第一個是參數是物件，第二個參數是事件(字串)，第三個參數也是物件(可省略)，第四個參數是要綁的事件(字串)，可以另外在別的地方定義好function再掛上來，也可以像上例一樣直接給它一個anonymous function
簡單的說，dojo.connect()可以翻譯成「把某個事件(或function)，綁到某個物件的某個事件(或function)上」，直接來看上面的例子：</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">dojo</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">dojo</span><span class="p">.</span><span class="nx">byId</span><span class="p">(</span><span class="s2">&quot;btn1&quot;</span><span class="p">),</span> <span class="s2">&quot;onclick&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">){</span>
</span><span class='line'>  <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Hello again, Dojo!&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>以上例來翻譯成白話文就是說「我把一個anonymous function，綁到id為btn1的那個按鈕的onclick事件上」，所以，當觸發這個按鈕的<code>onclick</code>事件(也就是點擊它)，就會跟著觸動這個function，丟出”Hello again, Dojo!”的字樣出來。</p>

<p>更多的細節可再參考Dojo的線上手冊。</p>

<p>目前國內用dojo的人看起似乎並不多，日前去書局弄了一本<a href="http://tlsj.tenlong.com.tw/WebModule/BookSearch/bookSearchViewAction.do?isbn=0596516487&amp;sid=45369">Dojo-The Definitive Guide</a>，仍在研究中，看來這個Dojo能做的事情還挺多，有心得再來繼續貼。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2008/09/10/omit-the-php-closing-tag/">Omit the PHP closing tag “?>”</a></h1>
      
        <fb:like href="http://blog.eddie.com.tw/2008/09/10/omit-the-php-closing-tag/" layout="button_count" show_faces="false" action="like" colorscheme="light"></fb:like>
      
    

    
      <p class="meta">
        




  
<time datetime="2008-09-10T10:50:00+08:00" pubdate>Sep 10<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>自從開始改用ZF後，開始慢慢的調整自己的code style，過程也許會痛苦，但相信結果應該會是甜美的。在ZF的<a href="http://framework.zend.com/manual/en/coding-standard.php-file-formatting.html">Coding Standard</a>裡有一段是這麼寫的：</p>

<blockquote><p>For files that contain only PHP code, the closing tag (“?>”) is never permitted. It is not required by PHP, and omitting it prevents the accidental injection of trailing whitespace into the response.</p><footer><strong>Zend Framework</strong><cite><a href='http://framework.zend.com/manual/en/coding-standard.php-file-formatting.html'>Coding Standard</a></cite></footer></blockquote>


<p>看不太懂哪來的injection，後來再翻了一下<a href="http://www.php.net/manual/en/language.basic-syntax.instruction-separation.php">PHP的官方資料</a>才發現也有提到這段：</p>

<blockquote><p>The closing tag of a PHP block at the end of a file is optional, and in some cases omitting it is helpful when using include() or require(), so unwanted whitespace will not occur at the end of files, and you will still be able to add headers to the response later. It is also handy if you use output buffering, and would not like to see added unwanted whitespace at the end of the parts generated by the included files.</p><footer><strong>PHP.net</strong><cite><a href='http://www.php.net/manual/en/language.basic-syntax.instruction-separation.php'>Instruction Separation</a></cite></footer></blockquote>


<p>後來自己動手做了一下實驗：</p>

<p>檔名 inc.php</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'><span class="c1">// do something</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>


<p>檔名：test.php</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'><span class="k">require_once</span><span class="p">(</span><span class="s1">&#39;inc.php&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nb">session_start</span><span class="p">();</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>


<p>執行test.php，看起來是沒什麼大問題；不過如果在inc.php的”?>”後面再按幾下enter，多加幾行空白行，test.php就會丟出警告訊息”Cannot send session cookie – headers already sent by..”，如果把inc.php的”?>”拿掉就ok了。</p>

<p>原來，在”?>”之後多按的幾個enter(newline)也會被當成資料丟給瀏覽器，所以如果include了這樣的檔案進來，會讓<code>header()</code>或<code>session_start()</code>之類的指令丟出”headers already sent by..”的警告訊息，而如果省去結尾的”?>”則可以避免這個問題。</p>

<p>果然魔鬼都是還是躲在細節裡，<a href="http://www.php.net/manual/en/">PHP的手冊</a>還是要多看啊!</p>

<p>順帶一提，ZF有<a href="http://framework.zend.com/docs/overview">PDF版的離線手冊</a>了，一千多頁，雖然不見得有比線上方便，但沒網路的時候倒還不錯用(我是把它放到PDA裡，上廁所可以看)</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page/33/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/page/31/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    
<section>
  <h1>高見龍</h1>
  愛玩又愛現&#8230;<a href="/about-eddie">More</a><br />
  <a href="/about-eddie"><img src="/images/blog/eddie_avatar.png" /></a>
  <br />

  
    <a href="http://twitter.com/eddiekao" class="twitter-follow-button" data-width="208px" data-show-count="true">Follow @eddiekao</a>
  

  <li></li>
  <br />聯絡：<br />eddie (at) digik.com.tw<br />+886-928-617-687<br />
  
  Welcome to make a donation if you think this blog is helpful to you :)
  <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
  <input type="hidden" name="cmd" value="_donations">
  <input type="hidden" name="business" value="eddie@digik.com.tw">
  <input type="hidden" name="lc" value="TW">
  <input type="hidden" name="item_name" value="Eddie Kao">
  <input type="hidden" name="no_note" value="0">
  <input type="hidden" name="currency_code" value="USD">
  <input type="hidden" name="bn" value="PP-DonationsBF:btn_donate_LG.gif:NonHostedGuest">
  <input type="image" src="https://www.paypalobjects.com/en_US/TW/i/btn/btn_donate_LG.gif" border="0" name="submit" alt="PayPal － 更安全、更簡單的線上付款方式！">
  </form>
  
  <br />

  <img src="/images/blog/badgeSpeaker.png" /><br />
  <img src="/images/blog/cert-ruby.png" /><br />
  <img src="/images/blog/cert-adobe.png" /><br />
  <img src="/images/blog/cert-linux.png" />
</section>

<section>
  <h1>最近的文章</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2015/03/24/class-and-module/">Ruby 語法放大鏡之「類別跟模組有什麼不一樣?」</a>
      </li>
    
      <li class="post">
        <a href="/2015/03/22/parameters/">Ruby 語法放大鏡之「Ruby 的參數」</a>
      </li>
    
      <li class="post">
        <a href="/2015/03/21/attr_accessor/">Ruby 語法放大鏡之「attr_accessor 是幹嘛的?」</a>
      </li>
    
      <li class="post">
        <a href="/2015/01/19/ios-apprentice-wanted/">新年新希望之誠徵 iOS app 開發學徒</a>
      </li>
    
      <li class="post">
        <a href="/2014/12/28/ruby-for-rails/">Ruby 語法放大鏡</a>
      </li>
    
      <li class="post">
        <a href="/2014/10/22/private-setter-in-ruby/">Private Setter in Ruby</a>
      </li>
    
      <li class="post">
        <a href="/2014/10/16/happy-programming-ruby/">Ruby 也可這樣寫</a>
      </li>
    
      <li class="post">
        <a href="/2014/08/22/lets-learn-ruby/">「有心人」之 Ruby 課程</a>
      </li>
    
      <li class="post">
        <a href="/2014/08/07/code-swift-with-vim/">Code Swift with Vim</a>
      </li>
    
      <li class="post">
        <a href="/2014/05/29/5xruby/">五倍祝福，五倍的紅寶石</a>
      </li>
    
  </ul>
</section>
<section>
<h1>分類</h1>
<span class='categories_tag'> <a href='/category/5xruby' style='font-size: 101.53846153846153%'>5xRuby(1)</a>  <a href='/category/actionscript' style='font-size: 136.9230769230769%'>ActionScript(24)</a>  <a href='/category/asp' style='font-size: 103.07692307692308%'>ASP(2)</a>  <a href='/category/aws' style='font-size: 101.53846153846153%'>AWS(1)</a>  <a href='/category/book' style='font-size: 101.53846153846153%'>Book(1)</a>  <a href='/category/browser' style='font-size: 103.07692307692308%'>Browser(2)</a>  <a href='/category/cocos2d' style='font-size: 101.53846153846153%'>Cocos2D(1)</a>  <a href='/category/coffeescript' style='font-size: 124.61538461538461%'>CoffeeScript(16)</a>  <a href='/category/css' style='font-size: 101.53846153846153%'>CSS(1)</a>  <a href='/category/diary' style='font-size: 160.0%'>Diary(39)</a>  <a href='/category/django' style='font-size: 121.53846153846155%'>Django(14)</a>  <a href='/category/dojo' style='font-size: 101.53846153846153%'>Dojo(1)</a>  <a href='/category/easeljs' style='font-size: 104.61538461538461%'>EaselJS(3)</a>  <a href='/category/flash' style='font-size: 158.46153846153845%'>Flash(38)</a>  <a href='/category/funny' style='font-size: 106.15384615384616%'>Funny(4)</a>  <a href='/category/happy-ruby' style='font-size: 103.07692307692308%'>Happy Ruby(2)</a>  <a href='/category/html5' style='font-size: 104.61538461538461%'>HTML5(3)</a>  <a href='/category/ios' style='font-size: 101.53846153846153%'>iOS(1)</a>  <a href='/category/ios-app-development' style='font-size: 135.3846153846154%'>iOS App Development(23)</a>  <a href='/category/javascript' style='font-size: 101.53846153846153%'>Javascript(1)</a>  <a href='/category/javascript' style='font-size: 138.46153846153845%'>JavaScript(25)</a>  <a href='/category/jquery' style='font-size: 101.53846153846153%'>jQuery(1)</a>  <a href='/category/jsdc' style='font-size: 103.07692307692308%'>JSDC(2)</a>  <a href='/category/linux' style='font-size: 123.07692307692308%'>Linux(15)</a>  <a href='/category/mysql' style='font-size: 101.53846153846153%'>MySQL(1)</a>  <a href='/category/objective-c' style='font-size: 126.15384615384616%'>Objective-C(17)</a>  <a href='/category/octopress' style='font-size: 106.15384615384616%'>Octopress(4)</a>  <a href='/category/party' style='font-size: 127.6923076923077%'>Party(18)</a>  <a href='/category/party' style='font-size: 101.53846153846153%'>party(1)</a>  <a href='/category/php' style='font-size: 133.84615384615384%'>PHP(22)</a>  <a href='/category/phpconf' style='font-size: 103.07692307692308%'>PHPConf(2)</a>  <a href='/category/phpconf-taiwan' style='font-size: 103.07692307692308%'>PHPConf Taiwan(2)</a>  <a href='/category/presentation' style='font-size: 116.92307692307692%'>Presentation(11)</a>  <a href='/category/programming' style='font-size: 104.61538461538461%'>Programming(3)</a>  <a href='/category/python' style='font-size: 146.15384615384616%'>Python(30)</a>  <a href='/category/rails' style='font-size: 101.53846153846153%'>Rails(1)</a>  <a href='/category/railsgirls' style='font-size: 101.53846153846153%'>RailsGirls(1)</a>  <a href='/category/robotlegs' style='font-size: 103.07692307692308%'>Robotlegs(2)</a>  <a href='/category/ruby' style='font-size: 146.15384615384616%'>Ruby(30)</a>  <a href='/category/ruby-on-rails' style='font-size: 113.84615384615384%'>Ruby on Rails(9)</a>  <a href='/category/rubykaigi' style='font-size: 103.07692307692308%'>RubyKaigi(2)</a>  <a href='/category/screencast' style='font-size: 106.15384615384616%'>Screencast(4)</a>  <a href='/category/security' style='font-size: 101.53846153846153%'>Security(1)</a>  <a href='/category/smarty' style='font-size: 101.53846153846153%'>Smarty(1)</a>  <a href='/category/swift' style='font-size: 101.53846153846153%'>Swift(1)</a>  <a href='/category/test' style='font-size: 101.53846153846153%'>Test(1)</a>  <a href='/category/tools' style='font-size: 143.0769230769231%'>Tools(28)</a>  <a href='/category/vim' style='font-size: 115.38461538461539%'>Vim(10)</a>  <a href='/category/webconf' style='font-size: 101.53846153846153%'>WebConf(1)</a>  <a href='/category/windows' style='font-size: 104.61538461538461%'>Windows(3)</a>  <a href='/category/zend-framework' style='font-size: 113.84615384615384%'>Zend Framework(9)</a> </span>
</section>

<section>
  <h1>回應</h1>
  <script type="text/javascript" src="http://eddie-blog.disqus.com/recent_comments_widget.js?num_items=5&hide_avatars=0&avatar_size=48&excerpt_length=50"></script>
</section>
<section>
  <h1>Tweets</h1>
  <a class="twitter-timeline" href="https://twitter.com/eddiekao" data-widget-id="410520084096884736">Tweets by @eddiekao</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  
    <a href="http://twitter.com/eddiekao" class="twitter-follow-button" data-width="208px" data-show-count="true">Follow @eddiekao</a>
  
</section>


<div style="width: 100%; height:375px;"><iframe src="http://www.plurk.com/getWidget?uid=3151385&amp;h=375&amp;w=260&amp;u_info=2&amp;bg=e8e8e8&tl=f2f2f2" width="100%" frameborder="0" height="100%" scrolling="no"></iframe></div>
<section>
  <h1>Flash/ASer</h1>
  <a href="http://blog.cjcat.net/" target="_blank">CJCAT</a>
    | <a href="http://erinylin.blogspot.com/" target="_blank">Erin</a>
    | <a href="http://etrex.blogspot.com/" target="_blank">Etrex</a>
    | <a href="http://grayliao.blogspot.com/" target="_blank">Gray</a>
    | <a href="http://greenchiou.blogspot.com/" target="_blank">Green</a>
    | <a href="http://blog.iamjason.com/" target="_blank">Jason</a>
    | <a href="http://masolin.blogspot.com/" target="_blank">Maso</a>
    | <a href="http://ticore.blogspot.com/" target="_blank">Ticore</a>
    | <a href="http://milkmidi.blogspot.com/" target="_blank">奶綠茶</a>
    | <a href="http://blog.lamb-mei.com/" target="_blank">羊小咩</a>
    | <a href="http://rhinotw.blogspot.com/" target="_blank">耶書</a>
    | <a href="http://hayamanotebook.blogspot.com/" target="_blank">葉山</a>
    | <a href="http://blog.ben.idv.tw/" target="_blank">邦邦</a>
    | <a href="http://mark-vann.blogspot.com/" target="_blank">馬克凡</a>
    | <a href="http://qops.blogspot.com/" target="_blank">新德老師</a>
    | <a href="http://blog.roodo.com/sayaku" target="_blank">阿邪</a>

  <h1>Rubyists</h1>
    <a href="http://ihower.tw/" target="_blank">ihower</a>
    | <a href="http://gogojimmy.net/" target="_blank">Jimmy</a>
    | <a href="http://blog.taian.su/" target="_blank">泰安</a>
    | <a href="http://blog.hsatac.net/" target="_blank">hSATAC</a>

  <h1>Friends</h1>
    <a href="http://etblue.blogspot.com/" target="_blank">ETBlue</a>
    | <a href="http://www.jaceju.net/" target="_blank">Jace</a>
    | <a href="http://4urs.blogspot.com/" target="_blank">Morris</a>
    | <a href="http://ricky.ez2.us/" target="_blank">Ricky</a>
    | <a href="http://blog.sd.idv.tw/" target="_blank">SDPower</a>
    | <a href="http://lindsayrain.blogspot.com/" target="_blank">謝小雨</a>
    | <a href="http://blog.hinablue.me/" target="_blank">閃光洽</a>
    | <a href="http://www.erblah.com" target="_blank">Er.Z</a>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - 高見龍 -
  <span class="credit">Powered by <a href="http://octopress.org" target="_blank">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'eddie-blog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




</body>
</html>
